

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>viscid.plot.mpl &mdash; Viscid 0.70.0 documentation</title>
  

  
  

  
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../../../',
        VERSION:'0.70.0',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Viscid 0.70.0 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../../index.html" class="icon icon-home"> Viscid</a>
        <form class="wy-form" action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#standard-setup">Standard Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#for-developers">For Developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../philosophy.html">Philosophy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../philosophy.html#data-abstraction">Data Abstraction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../custom_behavior.html">Custom Behavior (rc file)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../custom_behavior.html#common-customizations">Common Customizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../custom_behavior.html#viscid-grid-grid">viscid.grid.Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../custom_behavior.html#viscid-readers-openggcm-ggcmgrid">viscid.readers.openggcm.GGCMGrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../custom_behavior.html#viscid-readers-openggcm-ggcmfile">viscid.readers.openggcm.GGCMFile</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ex_reader.html">Reading/Plotting Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_reader.html#super-simple">Super Simple</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_reader.html#two-plots-one-figure">Two Plots, One Figure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_reader.html#playing-with-time">Playing with Time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ex_slicing.html">Slicing Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_slicing.html#spatial-slices">Spatial Slices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_slicing.html#temporal-slices">Temporal Slices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ex_openggcm.html">OpenGGCM Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_openggcm.html#gse-coordinates">GSE coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_openggcm.html#time-series">Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_openggcm.html#ionosphere-files">Ionosphere Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ex_calc.html">Calculator Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ex_calc.html#streamlines">Streamlines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../command_line.html">Command Line Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../command_line.html#viscid-2d">viscid_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../command_line.html#viscid-ts">viscid_ts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../command_line.html#viscid-diff">viscid_diff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../command_line.html#athena2xdmf">athena2xdmf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../command_line.html#bitmaskbits">bitmaskbits</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../viscid.html">viscid package</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Viscid</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="../../../index.html">Docs</a> &raquo;</li>
  <li><a href="">viscid.plot.mpl</a></li>
  
</ul>
<hr/>

          
  <h1>Source code for viscid.plot.mpl</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;Convenience module for making matplotlib plots</span>

<span class="sd">Your best friend in this module is the :meth:`plot` function, but the</span>
<span class="sd">best reference for all quirky options is :meth:`plot2d_field`.</span>

<span class="sd">Note: you can&#39;t set rc parameters for this module</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">distutils.version</span> <span class="kn">import</span> <span class="n">LooseVersion</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Normalize</span><span class="p">,</span> <span class="n">LogNorm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span> <span class="c">#pylint: disable=W0611</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
    <span class="n">_HAS_BASEMAP</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">_HAS_BASEMAP</span> <span class="o">=</span> <span class="bp">False</span>

<span class="kn">from</span> <span class="nn">viscid</span> <span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">viscid.compat</span> <span class="kn">import</span> <span class="n">string_types</span>
<span class="kn">from</span> <span class="nn">viscid</span> <span class="kn">import</span> <span class="n">field</span>
<span class="kn">from</span> <span class="nn">viscid</span> <span class="kn">import</span> <span class="n">coordinate</span>
<span class="kn">from</span> <span class="nn">viscid.calculator</span> <span class="kn">import</span> <span class="n">calc</span>
<span class="kn">from</span> <span class="nn">viscid.calculator.topology</span> <span class="kn">import</span> <span class="n">color_from_topology</span>
<span class="kn">from</span> <span class="nn">viscid.plot</span> <span class="kn">import</span> <span class="n">vseaborn</span>

<span class="n">__mpl_ver__</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span>
<span class="n">has_colorbar_gridspec</span> <span class="o">=</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="n">__mpl_ver__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="s">&quot;1.1.1&quot;</span><span class="p">)</span>
<span class="n">vseaborn</span><span class="o">.</span><span class="n">activate_from_viscid</span><span class="p">()</span>


<div class="viewcode-block" id="plot"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot">[docs]</a><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a field by dispatching to the most appropiate funciton</span>

<span class="sd">    * If fld has 1 spatial dimensions, call</span>
<span class="sd">      :meth:`plot1d_field(fld[selection], **kwargs)`</span>
<span class="sd">    * If fld has 2 spatial dimensions, call</span>
<span class="sd">      :meth:`plot2d_field(fld[selection], **kwargs)`</span>
<span class="sd">    * If fld is 2-D and has spherical coordinates (as is the case for</span>
<span class="sd">      ionospheric fields), try to use :meth:`plot2d_mapfield` which</span>
<span class="sd">      uses basemap to make its axes.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        selection (optional): something that describes a field slice</span>
<span class="sd">        kwargs: passed as keyword arguments to the actual plotting</span>
<span class="sd">            function</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (plot, colorbar)</span>
<span class="sd">            plot: matplotlib plot object</span>
<span class="sd">            colorbar: matplotlib colorbar object</span>

<span class="sd">    See Also:</span>
<span class="sd">        * :meth:`plot1d_field`: target for 1d fields</span>
<span class="sd">        * :meth:`plot2d_mapfield`: target for 2d spherical fields</span>
<span class="sd">        * :meth:`plot2d_field`: target for 2d fields</span>


<span class="sd">    Note:</span>
<span class="sd">        Field slices are done using &quot;slice_reduce&quot;, meaning extra</span>
<span class="sd">        dimensions are reduced out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">ScalarField</span><span class="p">):</span>
        <span class="n">fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">slice_reduce</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">ScalarField</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Selection &#39;{0}&#39; sliced away too many &quot;</span>
                             <span class="s">&quot;dimensions&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">selection</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plot1d_field</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">plot2d_mapfield</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot2d_field</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;mpl can only do 1-D or 2-D fields&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;I can only do scalar fields right now&quot;</span><span class="p">)</span>
</div>
<span class="k">def</span> <span class="nf">_parse_str</span><span class="p">(</span><span class="n">plot_opts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; opts string looks like &#39;log,x=-20_10&#39;, output is</span>
<span class="sd">    [[&#39;log&#39;], [&#39;x&#39;, &#39;-20&#39;, &#39;10&#39;]] &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plot_opts</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">plot_opts</span> <span class="o">=</span> <span class="n">plot_opts</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_opts</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">plot_opts</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">opt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_opts</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">plot_opts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">,</span> <span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plot_opts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">plot_opts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_opts</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

    <span class="n">plot_opts</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">plot_opts</span> <span class="k">if</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">plot_opts</span>

<span class="k">def</span> <span class="nf">_apply_parse_opts</span><span class="p">(</span><span class="n">plot_opts_str</span><span class="p">,</span> <span class="n">fld</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; modifies kwargs and returns a list of things to set after the fact</span>
<span class="sd">    kwargs are things that get added as arguments to the plot command</span>
<span class="sd">    plot_acts are set using plt.set(act[0], act[1], act[2]) &quot;&quot;&quot;</span>

    <span class="n">plot_opts</span> <span class="o">=</span> <span class="n">_parse_str</span><span class="p">(</span><span class="n">plot_opts_str</span><span class="p">)</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">plot_opts</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;lin&quot;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">opt</span><span class="p">)]</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;linear&quot;</span><span class="p">]])</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;linear&quot;</span><span class="p">]])</span>

            <span class="c"># scale will be centered around 0</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">absmax</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">abs_max</span><span class="p">(</span><span class="n">fld</span><span class="p">)</span>
                <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">absmax</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">absmax</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">,</span> <span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
            <span class="k">elif</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c"># plt.normalize is deprecated</span>
                <span class="c"># kwargs[&quot;norm&quot;] = plt.normalize(*opt[1:])</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="o">*</span><span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;log&quot;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">opt</span><span class="p">)]</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;linear&quot;</span><span class="p">]])</span>

            <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;log&quot;</span><span class="p">]])</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">,</span> <span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
            <span class="k">elif</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;linear&quot;</span><span class="p">]])</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LogNorm</span><span class="p">(</span><span class="o">*</span><span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;loglog&quot;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">opt</span><span class="p">)]</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;log&quot;</span><span class="p">]])</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;log&quot;</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LogNorm</span><span class="p">(</span><span class="o">*</span><span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">opt</span><span class="p">)]</span>
            <span class="c"># axis.set_xlim(*opt[1:])</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">,</span> <span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">opt</span><span class="p">)]</span>
            <span class="c"># axis.set_ylim(*opt[1:])</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">,</span> <span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;own&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;own axis doesn&#39;t seem to work yet...&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;ownx&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;own axis doesn&#39;t seem to work yet...&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;owny&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;own axis doesn&#39;t seem to work yet...&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="s">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ow">or</span> <span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;true&quot;</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">elif</span> <span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;false&quot;</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="c"># logger.warn(&quot;Unknown plot option ({0}) didn&#39;t parse &quot;</span>
            <span class="c">#              &quot;correctly&quot;.format(opt[0]))</span>


    <span class="c"># things that i just want to be automagic...</span>
    <span class="c"># use seismic cmap if the data looks centered around 0</span>
    <span class="k">if</span> <span class="s">&quot;norm&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s">&quot;cmap&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;norm&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">norm</span><span class="o">.</span><span class="n">vmin</span> <span class="ow">and</span> <span class="n">norm</span><span class="o">.</span><span class="n">vmax</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">vmax</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">axis</span><span class="p">,</span> <span class="n">actions</span>

<span class="k">def</span> <span class="nf">_apply_actions</span><span class="p">(</span><span class="n">acts</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">acts</span><span class="p">:</span>
        <span class="n">act</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">act</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<div class="viewcode-block" id="plot2d_field"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot2d_field">[docs]</a><span class="k">def</span> <span class="nf">plot2d_field</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">&quot;pcolormesh&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">plot_opts</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">do_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">action_ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">extra_args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a 2D Field using pcolormesh, contour, etc.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        style (str, optional): One of pcolormesh, pcolor, contour, or</span>
<span class="sd">            contourf</span>
<span class="sd">        ax (matplotlib axis, optional): Plot in a specific axis object</span>
<span class="sd">        plot_opts (str, optional): comma separated string of additional</span>
<span class="sd">            options with underscore separated argument options. They are</span>
<span class="sd">            summarized as follows...</span>

<span class="sd">            ================  ======================================</span>
<span class="sd">            Option            Description</span>
<span class="sd">            ================  ======================================</span>
<span class="sd">            lin               Use a linear scale for data with two</span>
<span class="sd">                              optional sub-options giving a range.</span>
<span class="sd">                              ``lin_0`` has the special meaning to</span>
<span class="sd">                              make the range symmetric about 0</span>
<span class="sd">            log               Use a log scale, with two sub-options</span>
<span class="sd">                              for the range</span>
<span class="sd">            loglog            same as log, but also make coordinates</span>
<span class="sd">                              log scaled</span>
<span class="sd">            x                 Set limits of x axis using 2 manditory</span>
<span class="sd">                              sub-options</span>
<span class="sd">            y                 Set limits of y axis using 2 manditory</span>
<span class="sd">                              sub-options</span>
<span class="sd">            grid [#f1]_       plot lines showing grid cells</span>
<span class="sd">            earth [#f1]_      plot a black and white Earth</span>
<span class="sd">            equalaxis [#f1]_  Use 1:1 aspect ratio for grid cells</span>
<span class="sd">                              (True by default)</span>
<span class="sd">            flip_plot [#f1]_  flip x and y axes (2d fields only)</span>
<span class="sd">            masknan           if true, nan values are masked, so</span>
<span class="sd">                              black if pcolor, or missing for</span>
<span class="sd">                              countours</span>
<span class="sd">            ================  ======================================</span>

<span class="sd">            .. [#f1] These options can be given as kwargs</span>

<span class="sd">            If a plot_opt is not understood, it is added to kwargs.</span>
<span class="sd">            Some plot_opt examples are:</span>
<span class="sd">            * ``lin_-300_300,earth``</span>
<span class="sd">            * ``log,x_-3_30,y_-10_10,cmap_afmhot``</span>
<span class="sd">            * ``lin_0,x_-10_20,grid,earth``</span>
<span class="sd">        kwargs: Some other keyword arguments are understood and</span>
<span class="sd">            described below, and all others are passed as keyword</span>
<span class="sd">            arguments to the matplotlib plotting functions. This way,</span>
<span class="sd">            one can pass arguments like cmap and the like.</span>

<span class="sd">    Other Parameters:</span>
<span class="sd">        colorbar (bool or dict): If dict, the items are passed to</span>
<span class="sd">            plt.colorbar as keyword arguments</span>
<span class="sd">        levels (int): Number of contours to follow (default: 10)</span>
<span class="sd">        do_labels: automatically label x/y axes and color bar</span>
<span class="sd">        show_grid (bool): Plot lines showing grid cells</span>
<span class="sd">        earth (bool): Plot a black and white circle representing Earth</span>
<span class="sd">            showing the sunlit half</span>
<span class="sd">        show (bool, optional): Call pyplot.show before returning</span>
<span class="sd">        action_ax: axis on which to call matplotlib functions... I</span>
<span class="sd">            don&#39;t even remember why this was necessary</span>
<span class="sd">        scale (float): multiply field by scalar before plotting, useful</span>
<span class="sd">            for changing units</span>
<span class="sd">        mod (list of floats): DEPRECATED, scale x and y axes by some</span>
<span class="sd">            factor</span>
<span class="sd">        extra_args (list): DEPRECATED, was used to pass args to</span>
<span class="sd">            matplotlib functions, like contour levels, but there</span>
<span class="sd">            is probably a better way to give these options</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">nr_sdims</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;I will only contour a 2d field&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">extra_args</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">extra_args</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">action_ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">action_ax</span> <span class="o">=</span> <span class="n">ax</span>

    <span class="c"># parse plot_opts and apply them</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">_apply_parse_opts</span><span class="p">(</span><span class="n">plot_opts</span><span class="p">,</span> <span class="n">fld</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="n">colorbar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;colorbar&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colorbar</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c"># make customizing plot type from command line possible</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;style&quot;</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
    <span class="n">earth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;earth&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">equalaxis</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;equalaxis&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">flip_plot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;flip_plot&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">masknan</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;masknan&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

    <span class="n">show_grid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;show_grid&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">show_grid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;g&quot;</span><span class="p">,</span> <span class="n">show_grid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_grid</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;edgecolors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;k&#39;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;linewidths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;antialiased&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c"># THIS IS BACKWARD, on account of the convention for</span>
    <span class="c"># Coordinates where z, y, x is used since that is how</span>
    <span class="c"># xdmf data is</span>
    <span class="n">namey</span><span class="p">,</span> <span class="n">namex</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">crds</span><span class="o">.</span><span class="n">axes</span> <span class="c"># fld.crds.get_culled_axes()</span>

    <span class="c"># pcolor mesh uses node coords, and cell data, if we have</span>
    <span class="c"># node data, fake it by using cell centered coords and</span>
    <span class="c"># trim the edges of the data... maybe i should just be</span>
    <span class="c"># extapolating the crds and keeping the edges...</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;pcolormesh&quot;</span><span class="p">,</span> <span class="s">&quot;pcolor&quot;</span><span class="p">]:</span>
        <span class="n">fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">as_cell_centered</span><span class="p">()</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">get_crds_nc</span><span class="p">((</span><span class="n">namex</span><span class="p">,</span> <span class="n">namey</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">iscentered</span><span class="p">(</span><span class="s">&quot;Node&quot;</span><span class="p">):</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">get_crds_nc</span><span class="p">((</span><span class="n">namex</span><span class="p">,</span> <span class="n">namey</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fld</span><span class="o">.</span><span class="n">iscentered</span><span class="p">(</span><span class="s">&quot;Cell&quot;</span><span class="p">):</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">get_crds_cc</span><span class="p">((</span><span class="n">namex</span><span class="p">,</span> <span class="n">namey</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;latlon&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
        <span class="c"># translate latitude from 0..180 to -90..90</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span>

    <span class="n">dat</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">dat</span> <span class="o">*=</span> <span class="n">scale</span>

    <span class="k">if</span> <span class="n">mod</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">*=</span> <span class="n">mod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Y</span> <span class="o">*=</span> <span class="n">mod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c"># print(x.shape, y.shape, fld.data.shape)</span>
    <span class="k">if</span> <span class="n">masknan</span><span class="p">:</span>
        <span class="n">dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dat</span><span class="p">),</span> <span class="n">dat</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">equalaxis</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">_apply_actions</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

    <span class="c"># ok, here&#39;s some raw hackery for contours</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;contourf&quot;</span><span class="p">,</span> <span class="s">&quot;contour&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">extra_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;levels&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">extra_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">if</span> <span class="s">&quot;norm&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;norm&quot;</span><span class="p">]</span>
            <span class="n">norm</span><span class="o">.</span><span class="n">autoscale_None</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="n">LogNorm</span><span class="p">):</span>
                <span class="n">extra_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span><span class="p">),</span>
                                            <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">vmax</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">colorbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s">&quot;ticks&quot;</span> <span class="ow">in</span> <span class="n">colorbar</span><span class="p">:</span>
                    <span class="n">colorbar</span><span class="p">[</span><span class="s">&quot;ticks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">):</span>
                <span class="n">extra_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;I should never be here&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flip_plot</span><span class="p">:</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>
        <span class="n">dat</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">T</span>
        <span class="n">namex</span><span class="p">,</span> <span class="n">namey</span> <span class="o">=</span> <span class="n">namey</span><span class="p">,</span> <span class="n">namex</span>

    <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&quot;pcolormesh&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">action_ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="o">*</span><span class="n">extra_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&quot;contour&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">action_ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="o">*</span><span class="n">extra_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&quot;colors&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&quot;contourf&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">action_ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="o">*</span><span class="n">extra_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&quot;pcolor&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">action_ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="o">*</span><span class="n">extra_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;I don&#39;t understand {0} 2d plot style&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">style</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">masknan</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">()</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">masknan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">()</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">)</span>

    <span class="c"># figure out the colorbar...</span>
    <span class="k">if</span> <span class="n">colorbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># unless otherwise specified, use_gridspec for</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s">&quot;use_gridspec&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">colorbar</span><span class="p">[</span><span class="s">&quot;use_gridspec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c"># ok, this way to pass options to colorbar is bad!!!</span>
        <span class="c"># but it&#39;s kind of the cleanest way to affect the colorbar?</span>
        <span class="k">if</span> <span class="n">masknan</span> <span class="ow">and</span> <span class="n">dat</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">colorbar</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">do_labels</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">fld</span><span class="o">.</span><span class="n">pretty_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="n">do_labels</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">namex</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">namey</span><span class="p">)</span>

    <span class="c"># _apply_acts(acts)</span>

    <span class="k">if</span> <span class="n">earth</span><span class="p">:</span>
        <span class="n">plot_earth</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">action_ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">mplshow</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">cbar</span>
</div>
<span class="k">def</span> <span class="nf">_mlt_labels</span><span class="p">(</span><span class="n">longitude</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;{0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">longitude</span> <span class="o">*</span> <span class="mf">24.0</span> <span class="o">/</span> <span class="mf">360.0</span><span class="p">)</span>

<div class="viewcode-block" id="plot2d_mapfield"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot2d_mapfield">[docs]</a><span class="k">def</span> <span class="nf">plot2d_mapfield</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&quot;polar&quot;</span><span class="p">,</span> <span class="n">hemisphere</span><span class="o">=</span><span class="s">&quot;north&quot;</span><span class="p">,</span>
                    <span class="n">drawcoastlines</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show_grid</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">lon_0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bounding_lat</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label_lat</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label_mlt</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot data on a map projection of a sphere</span>

<span class="sd">    The default projection is polar, but any other basemap projection</span>
<span class="sd">    can be used.</span>

<span class="sd">    Note:</span>
<span class="sd">        Parameters are in degrees, but if the projection is &#39;polar&#39;,</span>
<span class="sd">        then the plot is actually made in radians, which is important</span>
<span class="sd">        if you want to annotate a plot.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fld (Field): field whose crds are spherical</span>
<span class="sd">        projection (string): &#39;polar&#39; or Basemap projection to use</span>
<span class="sd">        hemisphere (string): &#39;north&#39; or &#39;south&#39;</span>
<span class="sd">        drawcoastlines (bool): If projection is a basemap projection,</span>
<span class="sd">            then draw coastlines, pretty cool, but not actually useful.</span>
<span class="sd">            NOTE: coastlines do NOT reflect UT time; London is always</span>
<span class="sd">            at midnight.</span>
<span class="sd">        show_grid (bool): draw grid lines</span>
<span class="sd">        lon_0 (float): center longitude (basemap projections only)</span>
<span class="sd">        lat_0 (fload): center latitude (basemap projections only)</span>
<span class="sd">        bounding_lat (float): bounding latitude in degrees from the</span>
<span class="sd">            nearest pole (not for all projections)</span>
<span class="sd">        title (bool, str): put a specific title on the plot, or with</span>
<span class="sd">            if a boolean, use the field&#39;s pretty_name.</span>
<span class="sd">        label_lat (bool, str): label latitudes at 80, 70, 60 degrees</span>
<span class="sd">            with sign indicating northern / southern hemisphere.</span>
<span class="sd">            if label_lat is &#39;from_pole&#39;, then the labels are 10, 20,</span>
<span class="sd">            30 for both hemispheres. Note that basemap projections</span>
<span class="sd">            won&#39;t label latitudes unless they hit the edge of the plot.</span>
<span class="sd">        label_mlt (bool): label magnetic local time</span>
<span class="sd">        kwargs: either mapping keyword arguments, or those that</span>
<span class="sd">            should be passed along to `plot2d_field`</span>

<span class="sd">    See Also:</span>
<span class="sd">        * :meth:`plot2d_field`: `plot2d_mapfield` basically just wraps</span>
<span class="sd">          this function setting up a Basemap first</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hemisphere</span> <span class="o">=</span> <span class="n">hemisphere</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s">&quot;north&quot;</span><span class="p">:</span>
        <span class="c"># def_projection = &quot;nplaea&quot;</span>
        <span class="c"># def_boundinglat = 40.0</span>
        <span class="n">latlabel_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s">&quot;south&quot;</span><span class="p">:</span>
        <span class="c"># def_projection = &quot;splaea&quot;</span>
        <span class="c"># def_boundinglat = -40.0</span>
        <span class="c"># FIXME: should I be doing this?</span>
        <span class="k">if</span> <span class="n">bounding_lat</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">bounding_lat</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="n">latlabel_arr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;hemisphere is either &#39;north&#39; or &#39;south&#39;&quot;</span><span class="p">)</span>

    <span class="c"># boundinglat = kwargs.pop(&quot;boundinglat&quot;, def_boundinglat)</span>
    <span class="c"># lon_0 = kwargs.pop(&quot;lon_0&quot;, 0.0)</span>
    <span class="c"># lat_0 = kwargs.pop(&quot;lat_0&quot;, None)</span>
    <span class="c"># drawcoastlines = kwargs.pop(&quot;drawcoastlines&quot;, False)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;ax&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="o">!=</span> <span class="s">&quot;polar&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_HAS_BASEMAP</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;NOTE: install the basemap for the desired spherical &quot;</span>
              <span class="s">&quot;projection; falling back to matplotlib&#39;s polar plot.&quot;</span><span class="p">)</span>
        <span class="n">projection</span> <span class="o">=</span> <span class="s">&quot;polar&quot;</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&quot;polar&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="n">__mpl_ver__</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="s">&quot;1.1&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;polar plots are annoying for matplotlib &lt; &quot;</span><span class="p">,</span>
                               <span class="s">&quot;version 1.1. Update your matplotlib and &quot;</span>
                               <span class="s">&quot;profit.&quot;</span><span class="p">)</span>

        <span class="n">absboundinglat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bounding_lat</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s">&quot;set_thetagrids&quot;</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">(),</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;polar&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Clobbering axis for subplot {0}; please give a polar &quot;</span>
                        <span class="s">&quot;axis to plot2d_mapfield if you indend to use it &quot;</span>
                        <span class="s">&quot;later.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()))</span>

        <span class="k">if</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s">&quot;north&quot;</span><span class="p">:</span>
            <span class="n">sl_fld</span> <span class="o">=</span> <span class="n">fld</span><span class="p">[</span><span class="s">&quot;lat=:{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">absboundinglat</span><span class="p">)]</span>
            <span class="n">maxlat</span> <span class="o">=</span> <span class="n">sl_fld</span><span class="o">.</span><span class="n">get_crd_nc</span><span class="p">(</span><span class="s">&#39;lat&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s">&quot;south&quot;</span><span class="p">:</span>
            <span class="n">sl_fld</span> <span class="o">=</span> <span class="n">fld</span><span class="p">[</span><span class="s">&quot;lat={0}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">180.0</span> <span class="o">-</span> <span class="n">absboundinglat</span><span class="p">)][</span><span class="s">&quot;lat=::-1&quot;</span><span class="p">]</span>
            <span class="n">maxlat</span> <span class="o">=</span> <span class="mf">180.0</span> <span class="o">-</span> <span class="n">sl_fld</span><span class="o">.</span><span class="n">get_crd_nc</span><span class="p">(</span><span class="s">&#39;lat&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">sl_fld</span><span class="o">.</span><span class="n">get_crds_nc</span><span class="p">([</span><span class="s">&#39;lat&#39;</span><span class="p">,</span> <span class="s">&#39;lon&#39;</span><span class="p">])</span>
        <span class="n">new_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">maxlat</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
        <span class="c"># FIXME: Matt&#39;s code had a - 0.5 * (lon[1] - lon[0]) here...</span>
        <span class="c"># I&#39;m omiting it</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_theta_offset</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span>
        <span class="c"># new_lon = (lon - 90.0) * np.pi / 180.0</span>
        <span class="n">new_lon</span> <span class="o">=</span> <span class="n">lon</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
        <span class="n">new_crds</span> <span class="o">=</span> <span class="n">coordinate</span><span class="o">.</span><span class="n">wrap_crds</span><span class="p">(</span><span class="s">&quot;nonuniform_spherical&quot;</span><span class="p">,</span>
                                        <span class="p">[(</span><span class="s">&#39;lat&#39;</span><span class="p">,</span> <span class="n">new_lat</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;lon&#39;</span><span class="p">,</span> <span class="n">new_lon</span><span class="p">)])</span>
        <span class="n">new_fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">sl_fld</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">crds</span><span class="o">=</span><span class="n">new_crds</span><span class="p">))</span>

        <span class="c"># print(fld.get_crds())</span>

        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;action_ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;do_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;equalaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">plot2d_field</span><span class="p">(</span><span class="n">new_fld</span><span class="p">,</span> <span class="n">show_grid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">new_fld</span><span class="o">.</span><span class="n">pretty_name</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_grid</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

            <span class="n">mlt_grid_pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">315</span><span class="p">)</span>
            <span class="n">mlt_labels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">label_mlt</span><span class="p">:</span>
                <span class="n">mlt_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_thetagrids</span><span class="p">(</span><span class="n">mlt_grid_pos</span><span class="p">,</span> <span class="n">mlt_labels</span><span class="p">)</span>

            <span class="n">abs_grid_dr</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">grid_dr</span> <span class="o">=</span> <span class="n">abs_grid_dr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">bounding_lat</span><span class="p">)</span>
            <span class="n">lat_grid_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">abs_grid_dr</span><span class="p">,</span> <span class="n">absboundinglat</span><span class="p">,</span> <span class="n">abs_grid_dr</span><span class="p">)</span>
            <span class="n">lat_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">abs_grid_dr</span><span class="p">,</span> <span class="n">absboundinglat</span><span class="p">,</span> <span class="n">abs_grid_dr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label_lat</span> <span class="o">==</span> <span class="s">&quot;from_pole&quot;</span><span class="p">:</span>
                <span class="n">lat_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;{0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lat_labels</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">label_lat</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s">&#39;north&#39;</span><span class="p">:</span>
                    <span class="n">lat_labels</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">lat_labels</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lat_labels</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span> <span class="o">+</span> <span class="n">lat_labels</span>
                <span class="n">lat_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;{0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lat_labels</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lat_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_rgrids</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">lat_grid_pos</span><span class="p">,</span> <span class="n">lat_labels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="n">lon_0</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="n">lat_0</span><span class="p">,</span>
                    <span class="n">boundinglat</span><span class="o">=</span><span class="n">bounding_lat</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;latlon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;action_ax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;do_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;equalaxis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">plot2d_field</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_grid</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_lat</span><span class="p">:</span>
                <span class="n">lat_lables</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lat_lables</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">latlabel_arr</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">lat_lables</span><span class="p">,</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">label_mlt</span><span class="p">:</span>
                <span class="n">mlt_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mlt_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">360.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
                            <span class="n">labels</span><span class="o">=</span><span class="n">mlt_labels</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">_mlt_labels</span><span class="p">,</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">drawcoastlines</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

</div>
<div class="viewcode-block" id="plot1d_field"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot1d_field">[docs]</a><span class="k">def</span> <span class="nf">plot1d_field</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">plot_opts</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">do_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">action_ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a 1D Field using lines</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fld: Field to plot</span>

<span class="sd">    See Also:</span>
<span class="sd">        * :meth:`plot2d_field`: Describes plot_opts, and all other</span>
<span class="sd">          keyword arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">namex</span><span class="p">,</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">crds</span><span class="o">.</span><span class="n">axes</span>
    <span class="k">if</span> <span class="n">fld</span><span class="o">.</span><span class="n">iscentered</span><span class="p">(</span><span class="s">&quot;Node&quot;</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">get_crd_nc</span><span class="p">(</span><span class="n">namex</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">fld</span><span class="o">.</span><span class="n">iscentered</span><span class="p">(</span><span class="s">&quot;Cell&quot;</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">get_crd_cc</span><span class="p">(</span><span class="n">namex</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">,</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">_apply_parse_opts</span><span class="p">(</span><span class="n">plot_opts</span><span class="p">,</span> <span class="n">fld</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">action_ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">action_ax</span> <span class="o">=</span> <span class="n">ax</span>
    <span class="n">masknan</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;masknan&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

    <span class="n">dat</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="n">masknan</span><span class="p">:</span>
        <span class="n">dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dat</span><span class="p">),</span> <span class="n">dat</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&quot;label&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">pretty_name</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">action_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">do_labels</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">namex</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">fld</span><span class="o">.</span><span class="n">pretty_name</span><span class="p">)</span>
    <span class="n">_apply_actions</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">mplshow</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="plot_streamlines"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot_streamlines">[docs]</a><span class="k">def</span> <span class="nf">plot_streamlines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">topology</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot lines on a matplotlib 3D plot, optionally colored by value</span>

<span class="sd">    Parameters:</span>
<span class="sd">        lines (list): A set of N lines. Elements should have the shape</span>
<span class="sd">            3xP where 3 is the axes zyx (in that order) and P is the</span>
<span class="sd">            number of points in the line. As an ndarray, the required</span>
<span class="sd">            shape is Nx3xP.</span>
<span class="sd">        topology (optional): Value used to color the lines. Should have</span>
<span class="sd">            length N.</span>
<span class="sd">        ax (matplotlib axis, optional): axis on which to plot</span>
<span class="sd">        show (bool, optional): plt.show() before returning</span>
<span class="sd">        equal (bool, optional): set 1:1 aspect ratio on axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">topology</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
            <span class="n">topology</span> <span class="o">=</span> <span class="n">topology</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">topo_color</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">topo_color</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">topo_color</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color_from_topology</span><span class="p">(</span><span class="n">topology</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">equal</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="plot_streamlines2d"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot_streamlines2d">[docs]</a><span class="k">def</span> <span class="nf">plot_streamlines2d</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">symdir</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">topology</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">flip_plot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Project 3D lines onto a 2D plot</span>

<span class="sd">    Parameters:</span>
<span class="sd">        lines (list): A set of N lines. Elements should have the shape</span>
<span class="sd">            3xP where 3 is the axes zyx (in that order) and P is the</span>
<span class="sd">            number of points in the line. As an ndarray, the required</span>
<span class="sd">            shape is Nx3xP.</span>
<span class="sd">        symdir (str, optional): one of xyz for the plane on which to</span>
<span class="sd">            orthogonally project lines. Not needed if lines are shaped</span>
<span class="sd">            Nx2xP.</span>
<span class="sd">        topology (optional): Value used to color the lines. Should have</span>
<span class="sd">            length N.</span>
<span class="sd">        ax (matplotlib axis, optional): axis on which to plot</span>
<span class="sd">        show (bool, optional): plt.show() before returning</span>
<span class="sd">        flip_plot (bool, optional): swap plot&#39;s x/y axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">p</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="n">topology</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
            <span class="n">topology</span> <span class="o">=</span> <span class="n">topology</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s">&quot;color&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">topo_color</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">topo_color</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">symdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">symdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">symdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;z&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;For 3d lines, symdir should be x, y, or z&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">flip_plot</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>

        <span class="k">if</span> <span class="n">topo_color</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color_from_topology</span><span class="p">(</span><span class="n">topology</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="plot2d_quiver"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot2d_quiver">[docs]</a><span class="k">def</span> <span class="nf">plot2d_quiver</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span> <span class="n">symdir</span><span class="p">,</span> <span class="n">downscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Put quivers on a 2D plot</span>

<span class="sd">    Parameters:</span>
<span class="sd">        fld: Vector field to plot</span>
<span class="sd">        symdir (str): One of xyz for direction orthogonal to 2D plane</span>
<span class="sd">        downscale (int, optional): only quiver every Nth grid cell</span>
<span class="sd">        kwargs: passed along to :meth:`plt.quiver`</span>

<span class="sd">    Note:</span>
<span class="sd">        There are some edge cases where downscale doesn&#39;t work.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: with dowscale != 1, this reveals a problem when slice and</span>
    <span class="c"># downscaling a field; i think this is a prickley one</span>
    <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">component_views</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">get_crds_cc</span><span class="p">(</span><span class="n">shaped</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">symdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">:</span>
        <span class="c"># x, y = ycc, zcc</span>
        <span class="n">pvx</span><span class="p">,</span> <span class="n">pvy</span> <span class="o">=</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span>
    <span class="k">elif</span> <span class="n">symdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;y&quot;</span><span class="p">:</span>
        <span class="c"># x, y = xcc, zcc</span>
        <span class="n">pvx</span><span class="p">,</span> <span class="n">pvy</span> <span class="o">=</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vz</span>
    <span class="k">elif</span> <span class="n">symdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;z&quot;</span><span class="p">:</span>
        <span class="c"># x, y = xcc, ycc</span>
        <span class="n">pvx</span><span class="p">,</span> <span class="n">pvy</span> <span class="o">=</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">downscale</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[::</span><span class="n">downscale</span><span class="p">]</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[::</span><span class="n">downscale</span><span class="p">]</span>
        <span class="n">pvx</span> <span class="o">=</span> <span class="n">pvx</span><span class="p">[::</span><span class="n">downscale</span><span class="p">]</span>
        <span class="n">pvy</span> <span class="o">=</span> <span class="n">pvy</span><span class="p">[::</span><span class="n">downscale</span><span class="p">]</span>
    <span class="c"># print(X.shape, Y.shape, pvx.shape, pvy.shape)</span>
    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">pvx</span><span class="p">,</span> <span class="n">pvy</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="scatter_3d"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.scatter_3d">[docs]</a><span class="k">def</span> <span class="nf">scatter_3d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot scattered points on a matplotlib 3d plot</span>

<span class="sd">    Parameters:</span>
<span class="sd">        points: something shaped 3xN for N points, where 3 are the</span>
<span class="sd">            zyx cartesian directions in that order</span>
<span class="sd">        c (str, optional): color (in matplotlib format)</span>
<span class="sd">        ax (matplotlib Axis, optional): axis on which to plot (should</span>
<span class="sd">            be a 3d axis)</span>
<span class="sd">        show (bool, optional): show</span>
<span class="sd">        kwargs: passed along to :meth:`plt.statter`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">equal</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="bp">None</span>

</div>
<div class="viewcode-block" id="mplshow"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.mplshow">[docs]</a><span class="k">def</span> <span class="nf">mplshow</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Calls :meth:`matplotlib.pyplot.show()`&quot;&quot;&quot;</span>
    <span class="c"># do i need to do anything special before i show?</span>
    <span class="c"># can&#39;t think of anything at this point...</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="tighten"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.tighten">[docs]</a><span class="k">def</span> <span class="nf">tighten</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calls `matplotlib.pyplot.tight_layout(**kwargs)`&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;No matplotlib tight layout support&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="plot_earth"><a class="viewcode-back" href="../../../viscid.plot.html#viscid.plot.mpl.plot_earth">[docs]</a><span class="k">def</span> <span class="nf">plot_earth</span><span class="p">(</span><span class="n">plane_spec</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">daycol</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">nightcol</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">crd_system</span><span class="o">=</span><span class="s">&quot;mhd&quot;</span><span class="p">,</span>
               <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a black and white Earth to show sunward direction</span>

<span class="sd">    Parameters:</span>
<span class="sd">        plane_spec: Specifies the plane for determining sunlit portion.</span>
<span class="sd">            This can be a :class:`viscid.field.Field` object to try to</span>
<span class="sd">            auto-discover the plane and crd_system, or it can be a</span>
<span class="sd">            string like &quot;y=0&quot;.</span>
<span class="sd">        axis (matplotlib Axis): axis on which to plot</span>
<span class="sd">        scale (float, optional): scale of earth</span>
<span class="sd">        rot (float, optional): Rotation of day/night side... I forget all</span>
<span class="sd">            the details :(</span>
<span class="sd">        daycol (str, optional): color of dayside (matplotlib format)</span>
<span class="sd">        nightcol (str, optional): color of nightside (matplotlib format)</span>
<span class="sd">        crd_system (str, optional): &#39;mhd&#39; or &#39;gse&#39;, can usually be</span>
<span class="sd">            deduced from plane_spec if it&#39;s a Field instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="kn">as</span> <span class="nn">mpatches</span>

    <span class="c"># this is kind of a hacky way to</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plane_spec</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
        <span class="n">crd_system</span> <span class="o">=</span> <span class="n">plane_spec</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;crd_system&quot;</span><span class="p">,</span> <span class="n">crd_system</span><span class="p">)</span>

        <span class="c"># take only the 1st reduced.nr_sdims... this should just work</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plane</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">plane_spec</span><span class="o">.</span><span class="n">deep_meta</span><span class="p">[</span><span class="s">&quot;reduced&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;No reduced dims in the field, i don&#39;t know what 2d </span><span class="se">\n</span><span class="s"> &quot;</span>
                          <span class="s">&quot;plane, we&#39;re in and can&#39;t figure out the size of earth.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">plane_spec</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">)]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">value</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;=</span> <span class="n">scale</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scale</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">value</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">crd_system</span> <span class="o">==</span> <span class="s">&quot;gse&quot;</span><span class="p">:</span>
        <span class="n">rot</span> <span class="o">=</span> <span class="mi">180</span>

    <span class="k">if</span> <span class="n">plane</span> <span class="o">==</span> <span class="s">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">plane</span> <span class="o">==</span> <span class="s">&#39;z&#39;</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Wedge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span> <span class="mi">90</span> <span class="o">+</span> <span class="n">rot</span><span class="p">,</span> <span class="mi">270</span> <span class="o">+</span> <span class="n">rot</span><span class="p">,</span>
                                      <span class="n">ec</span><span class="o">=</span><span class="n">nightcol</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">daycol</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">))</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Wedge</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span> <span class="mi">270</span> <span class="o">+</span> <span class="n">rot</span><span class="p">,</span> <span class="mi">450</span> <span class="o">+</span> <span class="n">rot</span><span class="p">,</span>
                                      <span class="n">ec</span><span class="o">=</span><span class="n">nightcol</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">nightcol</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">plane</span> <span class="o">==</span> <span class="s">&#39;x&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">nightcol</span><span class="p">,</span>
                                           <span class="n">fc</span><span class="o">=</span><span class="n">daycol</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">nightcol</span><span class="p">,</span>
                                           <span class="n">fc</span><span class="o">=</span><span class="n">nightcol</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="c">##</span>
<span class="c">## EOF</span>
<span class="c">##</span></div>
</pre></div>

          <footer>
  <hr/>

  <p>
      &copy; Copyright 2013, Kristofor Maynard.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://www.readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>